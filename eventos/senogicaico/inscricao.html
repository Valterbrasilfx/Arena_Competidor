<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscri√ß√£o - SENOGI - Etapa Caic√≥ | Arena Competidor</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        :root {
            --cor-primaria: #007bff;
            --cor-secundaria: #343a40;
            --cor-destaque: #28a745;
            --cor-fundo: #f8f9fa;
            --cor-texto: #495057;
            --cor-borda: #dee2e6;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--cor-fundo);
            color: var(--cor-texto);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            background-color: #000;
            border-bottom: 2px solid var(--cor-borda);
            border-radius: 8px 8px 0 0; 
        }

        header img {
            max-width: 200px;
        }

        h1, h2 {
            text-align: center;
            color: var(--cor-secundaria);
            font-weight: 700;
        }
        
        h1 {
            margin-top: 0;
        }

        form {
            display: grid;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        input, select {
            padding: 12px;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            font-size: 1rem;
            width: 100%;
            box-sizing: border-box;
            /* Estilo para campos desabilitados */
            background-color: #f1f1f1; 
            cursor: not-allowed;
        }
        
        select:enabled {
             background-color: #fff;
             cursor: pointer;
        }


        input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
        }

        .extrato {
            background-color: #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }

        .extrato h2 {
            margin-top: 0;
            text-align: left;
            border-bottom: 1px solid var(--cor-borda);
            padding-bottom: 10px;
        }

        .extrato p, .extrato h3 {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .extrato h3 {
            margin-top: 20px;
            font-size: 1.5rem;
            color: var(--cor-destaque);
        }

        button {
            background-color: var(--cor-destaque);
            color: #fff;
            padding: 15px 20px;
            border: none;
            border-radius: 4px;
            font-size: 1.2rem;
            cursor: pointer;
            width: 100%;
            margin-top: 30px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #218838;
        }

        /* Feedback de envio */
        #feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
        }

        /* --- Estilos para Responsividade --- */
        @media (max-width: 768px) {
            .container {
                margin: 0;
                padding: 15px;
                border-radius: 0;
                box-shadow: none;
            }

            header {
                border-radius: 0;
                margin-bottom: 20px;
                padding: 15px 0;
            }
            
            header img {
                max-width: 150px;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            form {
                gap: 15px;
            }
            
            input, select {
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            header img {
                max-width: 120px;
            }

            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.2rem;
            }

            .extrato p, .extrato h3 {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .extrato h3 {
                font-size: 1.2rem;
            }

            button {
                font-size: 1rem;
                padding: 12px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <img src="../../img/arena2.png" alt="Arena Competidor Logo">
        </header>

        <h1>Inscri√ß√£o SENOGI - Etapa Caic√≥</h1>
        
        <form id="inscricaoForm">
            <div class="form-group">
                <label for="nome">Nome Completo:</label>
                <input type="text" id="nome" name="nome" required>
            </div>

            <div class="form-group">
                <label for="cpf">CPF:</label>
                <input type="text" id="cpf" name="cpf" required>
            </div>

            <div class="form-group">
                <label for="sexo">Sexo:</label>
                <select id="sexo" name="sexo" required>
                    <option value="">Selecione...</option>
                    <option value="masculino">Masculino</option>
                    <option value="feminino">Feminino</option>
                </select>
            </div>

            <div class="form-group">
                <label for="dataNascimento">Data de Nascimento:</label>
                <input type="date" id="dataNascimento" name="dataNascimento" required>
            </div>
            
            <div class="form-group">
                <label for="ddd">DDD:</label>
                <input type="text" id="ddd" name="ddd" maxlength="2" required>
            </div>

            <div class="form-group">
                <label for="celular">Celular:</label>
                <input type="text" id="celular" name="celular" required>
            </div>

            <div class="form-group">
                <label for="email">E-mail:</label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="equipeSelect">Sua Equipe:</label>
                <select id="equipeSelect" required>
                    <option value="">Selecione a Equipe...</option>
                    <option value="Avanti Jiu-jitsu">Avanti Jiu-jitsu</option>
                    <option value="BTT">BTT</option>
                    <option value="Casc√£o Jiu Jitsu">Casc√£o Jiu Jitsu</option>
                    <option value="Checkmat">Checkmat</option>
                    <option value="Gadelha Team">Gadelha Team</option>
                    <option value="Infantaria BJJ">Infantaria BJJ</option>
                    <option value="Jonson Rodrigues">Jonson Rodrigues</option>
                    <option value="Kimura">Kimura</option>
                    <option value="SZT SN">SZT SN</option>
                    <option value="Nova Gera√ß√£o Nordeste">Nova Gera√ß√£o Nordeste</option>                  
                    <option value="Pitbull Brothers">Pitbull Brothers</option>
                    <option value="Projeto Social Guerreiros da F√©">Projeto Social Guerreiros da F√©</option>
                    <option value="ROX BJJ">ROX BJJ</option>
                    <option value="SZT">SZT</option>
                    <option value="Team Fernando Alves">Team Fernando Alves</option>
                    <option value="Outra">Outra (Digitar abaixo)</option>
                </select>
            </div>
            
            <div class="form-group" id="equipeOutraContainer" style="display:none;">
                <label for="equipeOutra">Nome da Equipe (Digite):</label>
                <input type="text" id="equipeOutra">
            </div>
            <input type="hidden" id="equipe" name="equipe" required>
            <div class="form-group">
                <label for="professorSelect">Professor:</label>
                <select id="professorSelect" required>
                    <option value="">Selecione o Professor...</option>
                    <option value="Baixinho">Baixinho</option>
                    <option value="Carly Fran">Carly Fran</option>
                    <option value="Cleyton Moura">Cleyton Moura</option>
                    <option value="Danilo Marques">Danilo Marques</option>
                    <option value="Elenilson Peixotinho">Elenilson Peixotinho</option>
                    <option value="Felipe Bunes">Felipe Bunes</option>
                    <option value="Francielly ">Francielly </option>
                    <option value="Gelson Teixeira">Gelson Teixeira</option>
                    <option value="George Costa">George Costa</option>
                    <option value="Ivanaldo Ferreira">Ivanaldo Ferreira</option>
                    <option value="Jos√© Victor">Jos√© Victor</option>
                    <option value="Josenilson Albino">Josenilson Albino</option>
                    <option value="Junior Santos">Junior Santos</option>
                    <option value="L√°zaro Fernandes">L√°zaro Fernandes</option>
                    <option value="Matheus Gadelha">Matheus Gadelha</option>
                    <option value="Pablo Forlan">Pablo Forlan</option>
                    <option value="Samara Saldanha">Samara Saldanha</option>
                    <option value="Watson">Watson</option>
                    <option value="Wellinson Medeiros">Wellinson Medeiros</option>
                    <option value="Outro">Outro (Digitar abaixo)</option>
                </select>
            </div>

            <div class="form-group" id="professorOutroContainer" style="display:none;">
                <label for="professorOutro">Nome do Professor (Digite):</label>
                <input type="text" id="professorOutro">
            </div>
            <input type="hidden" id="professor" name="professor" required>
            <div class="form-group">
                <label for="categoria">Sua Categoria de Idade:</label>
                <select id="categoria" name="categoria" required disabled>
                    <option value="">Preencha o Sexo e a Data de Nasc.</option>
                </select>
                <input type="hidden" id="categoriaIdade" name="categoriaIdade">
            </div>

            <div class="form-group">
                <label for="faixa">Sua Faixa:</label>
                <select id="faixa" name="faixa" required disabled>
                    <option value="">Selecione a Categoria</option>
                </select>
            </div>

            <div class="form-group">
                <label for="peso">Seu Peso (Divis√£o):</label>
                <select id="peso" name="peso" required disabled>
                    <option value="">Selecione a Faixa</option>
                </select>
            </div>
            
            
            <div class="form-group checkbox-group" id="absolutoContainer" style="display:none;">
                <input type="checkbox" id="absoluto" name="absoluto" value="Sim">
                <label for="absoluto">Participar do Absoluto (+ R$ 50,00)</label>
            </div>
        </form>

        <div class="extrato">
            <h2>Extrato da Inscri√ß√£o</h2>
            <p><span>Categoria, Faixa e Peso:</span> <span id="extratoCategoria">Aguardando preenchimento</span></p>
            <p><span>Valor da Inscri√ß√£o:</span> <span id="valorCategoria">R$ 90,00</span></p>
            <p id="extratoAbsoluto" style="display:none;"><span>Valor do Absoluto:</span> <span id="valorAbsoluto">R$ 50,00</span></p>
            <h3><span>Total a Pagar:</span> <span id="totalPagar">R$ 90,00</span></h3>
        </div>

        <button type="submit" form="inscricaoForm">Salvar Inscri√ß√£o e Ir para o Pagamento</button>
        
        <p id="feedback"></p>
    </div>

    <script>
        // ==========================================================
        // üö® URL DE IMPLANTA√á√ÉO DA PLANILHA GOOGLE (CORRIGIDA)
        const URL_GOOGLE_SCRIPT = 'https://script.google.com/macros/s/AKfycbyh7ulRzG9mRq3id8J1lKuWgw4c_M0o8LMLi9-s3tXybufvNuYedNmx7eZ5oY5kJ2to/exec'; 
        // ==========================================================

        const dataNascimentoInput = document.getElementById('dataNascimento');
        const sexoInput = document.getElementById('sexo'); 
        const categoriaSelect = document.getElementById('categoria'); 
        const categoriaIdadeInput = document.getElementById('categoriaIdade'); 
        const absolutoContainer = document.getElementById('absolutoContainer');
        const absolutoCheckbox = document.getElementById('absoluto');
        const extratoAbsoluto = document.getElementById('extratoAbsoluto');
        const totalPagar = document.getElementById('totalPagar');
        const faixaInput = document.getElementById('faixa');
        const pesoInput = document.getElementById('peso');
        const extratoCategoriaSpan = document.getElementById('extratoCategoria');
        const inscricaoForm = document.getElementById('inscricaoForm');
        const feedbackElement = document.getElementById('feedback');
        
        // NOVAS CONSTANTES PARA EQUIPE E PROFESSOR
        const equipeSelect = document.getElementById('equipeSelect');
        const equipeOutraInput = document.getElementById('equipeOutra');
        const professorSelect = document.getElementById('professorSelect');
        const professorOutroInput = document.getElementById('professorOutro');
        // FIM NOVAS CONSTANTES

        // ==========================================================
        // 1. REGRAS DE DIVIS√ÉO E TABELAS DE PESO/FAIXA (SUAS IDEIAS)
        // ==========================================================

        /**
         * Retorna a divis√£o de idade ou uma lista de categorias Master se for o caso.
         * @param {number} idade 
         * @returns {string | string[] | null} 
         */
        function obterDivisao(idade) {
            if (idade === 13) return "Infanto-Juvenil 1";
            if (idade === 14) return "Infanto-Juvenil 2";
            if (idade === 15) return "Infanto-Juvenil 3";
            if (idade >= 16 && idade <= 17) return "Juvenil";
            if (idade >= 18 && idade <= 29) return "Adulto";
            if (idade >= 30) {
                return obterMastersPermitidos(idade);
            }
            return null; 
        }

        /**
         * Retorna as categorias Master permitidas com base na idade.
         * @param {number} idade - A idade do atleta.
         * @returns {string[]} Um array de categorias Master (incluindo Adulto).
         */
        function obterMastersPermitidos(idade) {
            if (idade < 30) return [];
            const masters = [];
            // A ordem √© importante, pois o "Adulto" deve vir como √∫ltima op√ß√£o, se n√£o for o √∫nico.
            if (idade >= 61) masters.push("Master 7");
            if (idade >= 56) masters.push("Master 6");
            if (idade >= 51) masters.push("Master 5");
            if (idade >= 46) masters.push("Master 4");
            if (idade >= 41) masters.push("Master 3");
            if (idade >= 36) masters.push("Master 2");
            if (idade >= 30) masters.push("Master 1");
            
            // Adulto √© sempre uma op√ß√£o para Masters (IBJJF Rules)
            masters.push("Adulto"); 
            // Remove duplicatas e inverte a ordem para aparecer do mais novo para o mais velho (Adulto, Master 1, Master 2...)
            // Mas para o Master, a ordem correta na lista de sele√ß√£o √©: Master 1, Master 2... Adulto.
            // Para isso, faremos a inser√ß√£o na ordem desejada:
            const categoriasUnicas = ["Adulto"];
            if (idade >= 30 && !categoriasUnicas.includes("Master 1")) categoriasUnicas.push("Master 1");
            if (idade >= 36 && !categoriasUnicas.includes("Master 2")) categoriasUnicas.push("Master 2");
            if (idade >= 41 && !categoriasUnicas.includes("Master 3")) categoriasUnicas.push("Master 3");
            if (idade >= 46 && !categoriasUnicas.includes("Master 4")) categoriasUnicas.push("Master 4");
            if (idade >= 51 && !categoriasUnicas.includes("Master 5")) categoriasUnicas.push("Master 5");
            if (idade >= 56 && !categoriasUnicas.includes("Master 6")) categoriasUnicas.push("Master 6");
            if (idade >= 61 && !categoriasUnicas.includes("Master 7")) categoriasUnicas.push("Master 7");
            
            return masters.filter((v, i, a) => a.indexOf(v) === i);
        }


        /**
         * Objeto com pesos por divis√£o e sexo (MANTIDO)
         */
        const pesosPorDivisao = {
            "Pr√©-Mirim 1": {
                masculino: ["Pluma/Light-Feather at√© 17,9kg", "Pena/Feather at√© 20kg", "Leve/Light at√© 23kg", "M√©dio/Middle at√© 26kg", "Meio-Pesado/Medium-Heavy at√© 29kg", "Pesado/Heavy at√© 32kg", "Super-Pesado/Super-Heavy at√© 35kg", "Pesad√≠ssimo/Ultra-Heavy acima de 35kg"],
                feminino: ["Pluma/Light-Feather at√© 17,9kg", "Pena/Feather at√© 20kg", "Leve/Light at√© 23kg", "M√©dio/Middle at√© 26kg", "Meio-Pesado/Medium-Heavy at√© 29kg", "Pesado/Heavy at√© 32kg", "Super-Pesado/Super-Heavy at√© 35kg", "Pesad√≠ssimo/Ultra-Heavy acima de 35kg"]
            },
            "Pr√©-Mirim 2": {
                masculino: ["Pluma/Light-Feather at√© 17,9kg", "Pena/Feather at√© 20kg", "Leve/Light at√© 23kg", "M√©dio/Middle at√© 26kg", "Meio-Pesado/Medium-Heavy at√© 29kg", "Pesado/Heavy at√© 32kg", "Super-Pesado/Super-Heavy at√© 35kg", "Pesad√≠ssimo/Ultra-Heavy acima de 35kg"],
                feminino: ["Pluma/Light-Feather at√© 17,9kg", "Pena/Feather at√© 20kg", "Leve/Light at√© 23kg", "M√©dio/Middle at√© 26kg", "Meio-Pesado/Medium-Heavy at√© 29kg", "Pesado/Heavy at√© 32kg", "Super-Pesado/Super-Heavy at√© 35kg", "Pesad√≠ssimo/Ultra-Heavy acima de 35kg"]
            },
            "Pr√©-Mirim 3": {
                masculino: ["Pluma/Light-Feather at√© 21kg", "Pena/Feather at√© 24kg", "Leve/Light at√© 27,2kg", "M√©dio/Middle at√© 30,2kg", "Meio-Pesado/Medium-Heavy at√© 33,2kg", "Pesado/Heavy at√© 36,2kg", "Super-Pesado/Super-Heavy at√© 39,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 39,3kg"],
                feminino: ["Pluma/Light-Feather at√© 21kg", "Pena/Feather at√© 24kg", "Leve/Light at√© 27,2kg", "M√©dio/Middle at√© 30,2kg", "Meio-Pesado/Medium-Heavy at√© 33,2kg", "Pesado/Heavy at√© 36,2kg", "Super-Pesado/Super-Heavy at√© 39,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 39,3kg"]
            },
            "Mirim 1": {
                masculino: ["Pluma/Light-Feather at√© 21kg", "Pena/Feather at√© 24kg", "Leve/Light at√© 27,2kg", "M√©dio/Middle at√© 30,2kg", "Meio-Pesado/Medium-Heavy at√© 33,2kg", "Pesado/Heavy at√© 36,2kg", "Super-Pesado/Super-Heavy at√© 39,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 39,3kg"],
                feminino: ["Pluma/Light-Feather at√© 21kg", "Pena/Feather at√© 24kg", "Leve/Light at√© 27,2kg", "M√©dio/Middle at√© 30,2kg", "Meio-Pesado/Medium-Heavy at√© 33,2kg", "Pesado/Heavy at√© 36,2kg", "Super-Pesado/Super-Heavy at√© 39,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 39,3kg"]
            },
            "Mirim 2": {
                masculino: ["Galo/Rooster at√© 24kg", "Pluma/Light-Feather at√© 27kg", "Pena/Feather at√© 30,2kg", "Leve/Light at√© 33,2kg", "M√©dio/Middle at√© 36,2kg", "Meio-Pesado/Medium-Heavy at√© 39,3kg", "Pesado/Heavy at√© 42,3kg", "Super-Pesado/Super-Heavy at√© 45,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 45,3kg"],
                feminino: ["Galo/Rooster at√© 24kg", "Pluma/Light-Feather at√© 27kg", "Pena/Feather at√© 30,2kg", "Leve/Light at√© 33,2kg", "M√©dio/Middle at√© 36,2kg", "Meio-Pesado/Medium-Heavy at√© 39,3kg", "Pesado/Heavy at√© 42,3kg", "Super-Pesado/Super-Heavy at√© 45,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 45,3kg"]
            },
            "Mirim 3": {
                masculino: ["Galo/Rooster at√© 24kg", "Pluma/Light-Feather at√© 27kg", "Pena/Feather at√© 30,2kg", "Leve/Light at√© 33,2kg", "M√©dio/Middle at√© 36,2kg", "Meio-Pesado/Medium-Heavy at√© 39,3kg", "Pesado/Heavy at√© 42,3kg", "Super-Pesado/Super-Heavy at√© 45,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 45,3kg"],
                feminino: ["Galo/Rooster at√© 24kg", "Pluma/Light-Feather at√© 27kg", "Pena/Feather at√© 30,2kg", "Leve/Light at√© 33,2kg", "M√©dio/Middle at√© 36,2kg", "Meio-Pesado/Medium-Heavy at√© 39,3kg", "Pesado/Heavy at√© 42,3kg", "Super-Pesado/Super-Heavy at√© 45,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 45,3kg"]
            },
            "Infantil 1": {
                masculino: ["Galo/Rooster at√© 32,2kg", "Pluma/Light-Feather at√© 36,2kg", "Pena/Feather at√© 40,3kg", "Leve/Light at√© 44,3kg", "M√©dio/Middle at√© 48,3kg", "Meio-Pesado/Medium-Heavy at√© 52,5kg", "Pesado/Heavy at√© 56,5kg", "Super-Pesado/Super-Heavy at√© 60,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 60,5kg"],
                feminino: ["Galo/Rooster at√© 32,2kg", "Pluma/Light-Feather at√© 36,2kg", "Pena/Feather at√© 40,3kg", "Leve/Light at√© 44,3kg", "M√©dio/Middle at√© 48,3kg", "Meio-Pesado/Medium-Heavy at√© 52,5kg", "Pesado/Heavy at√© 56,5kg", "Super-Pesado/Super-Heavy at√© 60,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 60,5kg"]
            },
            "Infantil 2": {
                masculino: ["Galo/Rooster at√© 32,2kg", "Pluma/Light-Feather at√© 36,2kg", "Pena/Feather at√© 40,3kg", "Leve/Light at√© 44,3kg", "M√©dio/Middle at√© 48,3kg", "Meio-Pesado/Medium-Heavy at√© 52,5kg", "Pesado/Heavy at√© 56,5kg", "Super-Pesado/Super-Heavy at√© 60,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 60,5kg"],
                feminino: ["Galo/Rooster at√© 32,2kg", "Pluma/Light-Feather at√© 36,2kg", "Pena/Feather at√© 40,3kg", "Leve/Light at√© 44,3kg", "M√©dio/Middle at√© 48,3kg", "Meio-Pesado/Medium-Heavy at√© 52,5kg", "Pesado/Heavy at√© 56,5kg", "Super-Pesado/Super-Heavy at√© 60,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 60,5kg"]
            },
            "Infantil 3": {
                masculino: ["Galo/Rooster at√© 36,2kg", "Pluma/Light-Feather at√© 40,3kg", "Pena/Feather at√© 44,3kg", "Leve/Light at√© 48,3kg", "M√©dio/Middle at√© 52,5kg", "Meio-Pesado/Medium-Heavy at√© 56,5kg", "Pesado/Heavy at√© 60,5kg", "Super-Pesado/Super-Heavy at√© 65kg", "Pesad√≠ssimo/Ultra-Heavy acima de 65kg"],
                feminino: ["Galo/Rooster at√© 36,2kg", "Pluma/Light-Feather at√© 40,3kg", "Pena/Feather at√© 44,3kg", "Leve/Light at√© 48,3kg", "M√©dio/Middle at√© 52,5kg", "Meio-Pesado/Medium-Heavy at√© 56,5kg", "Pesado/Heavy at√© 60,5kg", "Super-Pesado/Super-Heavy at√© 65kg", "Pesad√≠ssimo/Ultra-Heavy acima de 65kg"]
            },
            "Infanto-Juvenil 1": {
                masculino: ["Galo/Rooster at√© 36,2kg", "Pluma/Light-Feather at√© 40,3kg", "Pena/Feather at√© 44,3kg", "Leve/Light at√© 48,3kg", "M√©dio/Middle at√© 52,5kg", "Meio-Pesado/Medium-Heavy at√© 56,5kg", "Pesado/Heavy at√© 60,5kg", "Super-Pesado/Super-Heavy at√© 65kg", "Pesad√≠ssimo/Ultra-Heavy acima de 65kg"],
                feminino: ["Galo/Rooster at√© 36,2kg", "Pluma/Light-Feather at√© 40,3kg", "Pena/Feather at√© 44,3kg", "Leve/Light at√© 48,3kg", "M√©dio/Middle at√© 52,5kg", "Meio-Pesado/Medium-Heavy at√© 56,5kg", "Pesado/Heavy at√© 60,5kg", "Super-Pesado/Super-Heavy at√© 65kg", "Pesad√≠ssimo/Ultra-Heavy acima de 65kg"]
            },
            "Infanto-Juvenil 2": {
                masculino: ["Galo/Rooster at√© 44,3kg", "Pluma/Light-Feather at√© 48,3kg", "Pena/Feather at√© 52,5kg", "Leve/Light at√© 56,5kg", "M√©dio/Middle at√© 60,5kg", "Meio-Pesado/Medium-Heavy at√© 65kg", "Pesado/Heavy at√© 69kg", "Super-Pesado/Super-Heavy at√© 73kg", "Pesad√≠ssimo/Ultra-Heavy acima de 73kg"],
                feminino: ["Galo/Rooster at√© 40,3kg", "Pluma/Light-Feather at√© 44,3kg", "Pena/Feather at√© 48,3kg", "Leve/Light at√© 52,5kg", "M√©dio/Middle at√© 56,5kg", "Meio-Pesado/Medium-Heavy at√© 60,5kg", "Pesado/Heavy at√© 65kg", "Super-Pesado/Super-Heavy at√© 69kg", "Pesad√≠ssimo/Ultra-Heavy acima de 69kg"]
            },
            "Infanto-Juvenil 3": {
                 masculino: ["Galo/Rooster at√© 44,3kg", "Pluma/Light-Feather at√© 48,3kg", "Pena/Feather at√© 52,5kg", "Leve/Light at√© 56,5kg", "M√©dio/Middle at√© 60,5kg", "Meio-Pesado/Medium-Heavy at√© 65kg", "Pesado/Heavy at√© 69kg", "Super-Pesado/Super-Heavy at√© 73kg", "Pesad√≠ssimo/Ultra-Heavy acima de 73kg"],
                feminino: ["Galo/Rooster at√© 40,3kg", "Pluma/Light-Feather at√© 44,3kg", "Pena/Feather at√© 48,3kg", "Leve/Light at√© 52,5kg", "M√©dio/Middle at√© 56,5kg", "Meio-Pesado/Medium-Heavy at√© 60,5kg", "Pesado/Heavy at√© 65kg", "Super-Pesado/Super-Heavy at√© 69kg", "Pesad√≠ssimo/Ultra-Heavy acima de 69kg"]
            },
            "Juvenil": {
                masculino: ["Galo/Rooster at√© 53,5kg", "Pluma/Light-Feather at√© 58,5kg", "Pena/Feather at√© 64kg", "Leve/Light at√© 69kg", "M√©dio/Middle at√© 74kg", "Meio-Pesado/Medium-Heavy at√© 79,3kg", "Pesado/Heavy at√© 84,3kg", "Super-Pesado/Super-Heavy at√© 89,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 89,3kg"],
                feminino: ["Galo/Rooster at√© 44,3kg", "Pluma/Light-Feather at√© 48,3kg", "Pena/Feather at√© 52,5kg", "Leve/Light at√© 56,5kg", "M√©dio/Middle at√© 60,5kg", "Meio-Pesado/Medium-Heavy at√© 65kg", "Pesado/Heavy at√© 69kg", "Super-Pesado/Super-Heavy at√© 73kg", "Pesad√≠ssimo/Ultra-Heavy acima de 73kg"]
            },
            "Adulto": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 1": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 2": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 3": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 4": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 5": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 6": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
            "Master 7": {
                masculino: ["Galo/Rooster at√© 57,5kg", "Pluma/Light-Feather at√© 64kg", "Pena/Feather at√© 70kg", "Leve/Light at√© 76kg", "M√©dio/Middle at√© 82,3kg", "Meio-Pesado/Medium-Heavy at√© 88,3kg", "Pesado/Heavy at√© 94,3kg", "Super-Pesado/Super-Heavy at√© 100,5kg", "Pesad√≠ssimo/Ultra-Heavy acima de 100,5kg"],
                feminino: ["Galo/Rooster at√© 48,5kg", "Pluma/Light-Feather at√© 53,5kg", "Pena/Feather at√© 58,5kg", "Leve/Light at√© 64kg", "M√©dio/Middle at√© 69kg", "Meio-Pesado/Medium-Heavy at√© 74kg", "Pesado/Heavy at√© 79,3kg", "Super-Pesado/Super-Heavy at√© 84,3kg", "Pesad√≠ssimo/Ultra-Heavy acima de 84,3kg"]
            },
        };

        /**
         * Objeto com faixas por divis√£o (categoria de idade) (MANTIDO)
         */
        const faixasPorDivisao = {
            "Infanto-Juvenil 1": ["Branca", "Cinza", "Amarela", "Laranja", "Verde"],
            "Infanto-Juvenil 2": ["Branca", "Cinza", "Amarela", "Laranja", "Verde"],
            "Infanto-Juvenil 3": ["Branca", "Cinza", "Amarela", "Laranja", "Verde"],
            "Juvenil": ["Branca", "Azul"],
            "Adulto": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 1": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 2": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 3": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 4": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 5": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 6": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
            "Master 7": ["Branca", "Azul", "Roxa", "Marrom", "Preta"],
        };

        // ==========================================================
        // 2. FUN√á√ïES DE C√ÅLCULO E POPULAMENTO DE DROPDOWNS (MANTIDAS)
        // ==========================================================
        
        function calcularIdade(dataNascimento) {
            const hoje = new Date();
            const nascimento = new Date(dataNascimento);
            let idade = hoje.getFullYear() - nascimento.getFullYear();
            const mes = hoje.getMonth() - nascimento.getMonth();
            if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                idade--;
            }
            return idade;
        }

        /**
         * Limpa e desabilita um select.
         */
        function limparOpcoesSelect(selectElement, defaultText, disable = true) {
            selectElement.innerHTML = `<option value="">${defaultText}</option>`;
            selectElement.disabled = disable;
            selectElement.required = !disable; 
            if (selectElement.id === 'categoria') {
                // Ao limpar a categoria, garante que os dependentes tamb√©m sejam limpos e desabilitados
                limparOpcoesSelect(faixaInput, 'Selecione a Categoria', true);
                limparOpcoesSelect(pesoInput, 'Selecione a Faixa', true);
            }
            if (selectElement.id === 'faixa') {
                limparOpcoesSelect(pesoInput, 'Selecione a Faixa', true);
            }
        }

        function popularCategorias() {
            const dataNasc = dataNascimentoInput.value;
            const sexo = sexoInput.value;
            const idade = dataNasc ? calcularIdade(dataNasc) : null;
            
            // Limpa o estado atual
            limparOpcoesSelect(categoriaSelect, 'Preencha o Sexo e a Data de Nasc.', true);
            absolutoContainer.style.display = 'none';
            absolutoCheckbox.checked = false;

            if (!dataNasc || !sexo || idade < 4) {
                atualizarExtrato();
                return;
            }

            const categorias = obterDivisao(idade);

            if (categorias) {
                categoriaSelect.disabled = false;
                categoriaSelect.required = true;

                // Se for um array (Master/Adulto), adiciona as op√ß√µes
                if (Array.isArray(categorias)) {
                    limparOpcoesSelect(categoriaSelect, 'Selecione uma categoria', false);
                    categorias.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        categoriaSelect.appendChild(option);
                    });
                } else {
                    // Se for uma string (Juvenil e menores)
                    categoriaSelect.innerHTML = `<option value="${categorias}">${categorias}</option>`;
                    categoriaSelect.value = categorias; // Seleciona automaticamente
                    // Se a categoria for preenchida, j√° pode popular as faixas imediatamente
                    popularFaixas();
                }
            }
            atualizarExtrato();
        }

        function popularFaixas() {
            const categoria = categoriaSelect.value;
            // Limpa as op√ß√µes de faixa e peso, desabilitando-os
            limparOpcoesSelect(faixaInput, 'Selecione a Categoria', true);
            limparOpcoesSelect(pesoInput, 'Selecione a Faixa', true);
            
            // Controle do Absoluto
            const permiteAbsoluto = ['Juvenil', 'Adulto', 'Master 1', 'Master 2', 'Master 3', 'Master 4', 'Master 5', 'Master 6', 'Master 7'].includes(categoria);
            absolutoContainer.style.display = permiteAbsoluto ? 'flex' : 'none';
            if (!permiteAbsoluto) {
                absolutoCheckbox.checked = false;
            }

            if (categoria && faixasPorDivisao[categoria]) {
                faixaInput.disabled = false;
                faixaInput.required = true;
                limparOpcoesSelect(faixaInput, 'Selecione sua faixa', false);
                
                faixasPorDivisao[categoria].forEach(faixa => {
                    const option = document.createElement('option');
                    option.value = faixa.toLowerCase();
                    option.textContent = faixa;
                    faixaInput.appendChild(option);
                });
            }

            atualizarExtrato();
        }

        function popularPesos() {
            const categoria = categoriaSelect.value;
            const sexo = sexoInput.value;
            const faixa = faixaInput.value; // N√£o usado no filtro, mas garante que a faixa foi selecionada
            
            // Limpa as op√ß√µes de peso, desabilitando-o
            limparOpcoesSelect(pesoInput, 'Selecione a Faixa', true);

            if (categoria && sexo && faixa && pesosPorDivisao[categoria] && pesosPorDivisao[categoria][sexo]) {
                pesoInput.disabled = false;
                pesoInput.required = true;
                limparOpcoesSelect(pesoInput, 'Selecione seu peso (Divis√£o)', false);
                
                pesosPorDivisao[categoria][sexo].forEach(peso => {
                    const option = document.createElement('option');
                    // Cria um valor (value) simplificado (ex: Galo/Rooster -> galo)
                    const value = peso.split('/')[0].trim().toLowerCase().replace(' ', '-'); 
                    option.value = value;
                    option.textContent = peso;
                    pesoInput.appendChild(option);
                });
            }
            atualizarExtrato();
        }
        
        // --- FUN√á√ïES PARA GERENCIAR SELECT/OUTRA (MANTIDAS) ---
        function gerenciarEquipe() {
            const equipeOutraContainer = document.getElementById('equipeOutraContainer');
            const equipeHiddenInput = document.getElementById('equipe');
            const valorSelecionado = equipeSelect.value;

            if (valorSelecionado === 'Outra') {
                // Se for "Outra", mostra o campo de digita√ß√£o e o torna obrigat√≥rio
                equipeOutraContainer.style.display = 'flex';
                equipeOutraInput.required = true;
                // O valor final √© o que for digitado no campo extra
                equipeHiddenInput.value = equipeOutraInput.value;
            } else {
                // Se for uma equipe pr√©-definida, esconde o campo e o limpa
                equipeOutraContainer.style.display = 'none';
                equipeOutraInput.required = false;
                equipeOutraInput.value = '';
                
                // O valor final √© o do select
                equipeHiddenInput.value = valorSelecionado;
            }
            
            // Garante que o hidden input seja required se o select n√£o for selecionado.
            equipeHiddenInput.required = valorSelecionado === '' ? true : false;
        }

        function gerenciarProfessor() {
            const professorOutraContainer = document.getElementById('professorOutroContainer');
            const professorHiddenInput = document.getElementById('professor');
            const valorSelecionado = professorSelect.value;

            if (valorSelecionado === 'Outro') {
                professorOutraContainer.style.display = 'flex';
                professorOutroInput.required = true;
                // O valor final √© o que for digitado no campo extra
                professorHiddenInput.value = professorOutroInput.value;
            } else {
                professorOutraContainer.style.display = 'none';
                professorOutroInput.required = false;
                professorOutroInput.value = '';
                
                // O valor final √© o do select
                professorHiddenInput.value = valorSelecionado;
            }

            professorHiddenInput.required = valorSelecionado === '' ? true : false;
        }
        // --- FIM FUN√á√ïES SELECT/OUTRA ---
        
        // --- FUN√á√ïES DE EXTRACTO E ENVIO (MANTIDAS) ---

        function atualizarExtrato() {
            let total = 90.00;
            const categoria = categoriaSelect.value || 'Aguardando...';
            const faixa = faixaInput.options[faixaInput.selectedIndex]?.text || 'Aguardando...';
            const peso = pesoInput.options[pesoInput.selectedIndex]?.text || 'Aguardando...';
            const valorAbsoluto = 50.00;

            // Define o valor do campo hidden para ser enviado
            categoriaIdadeInput.value = categoria;
            
            const permiteAbsoluto = ['Juvenil', 'Adulto', 'Master 1', 'Master 2', 'Master 3', 'Master 4', 'Master 5', 'Master 6', 'Master 7'].includes(categoria);

            if (absolutoCheckbox.checked && permiteAbsoluto) {
                total += valorAbsoluto;
                extratoAbsoluto.style.display = 'flex';
            } else {
                extratoAbsoluto.style.display = 'none';
            }

            extratoCategoriaSpan.innerText = `${categoria}, ${faixa}, ${peso}`;
            totalPagar.innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
        }
        
        // --- FUN√á√ÉO PRINCIPAL DE ENVIO DE DADOS (URL CORRIGIDA) ---
        async function enviarParaPlanilha(event) {
            event.preventDefault(); 
            
            // AJUSTE CRUCIAL: Chama as fun√ß√µes para atualizar o valor final dos campos antes de enviar
            gerenciarEquipe();
            gerenciarProfessor();

            if (!inscricaoForm.checkValidity()) {
                inscricaoForm.reportValidity(); 
                return;
            }

            feedbackElement.textContent = 'Enviando dados... por favor, aguarde.';
            
            const formData = new FormData(inscricaoForm);
            formData.append('valor_total', totalPagar.innerText); 
            
            const categoriaSelecionada = categoriaSelect.value;
            const permiteAbsoluto = ['Juvenil', 'Adulto', 'Master 1', 'Master 2', 'Master 3', 'Master 4', 'Master 5', 'Master 6', 'Master 7'].includes(categoriaSelecionada);

            if (absolutoCheckbox.checked && permiteAbsoluto) {
                formData.set('absoluto', 'Sim');
            } else {
                formData.set('absoluto', 'N√£o');
            }
            
            const params = new URLSearchParams(formData).toString();

            try {
                const response = await fetch(URL_GOOGLE_SCRIPT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params
                });

                const data = await response.json();

                if (data.resultado === "sucesso") {
                    feedbackElement.textContent = '‚úÖ Inscri√ß√£o salva! Redirecionando para o Pagamento...';
                    feedbackElement.style.backgroundColor = '#d4edda';
                    feedbackElement.style.color = '#155724';
                    
                    // üéØ CAPTURA E PASSA DADOS PARA pagamentos.html VIA URL
                    const nomeAtleta = document.getElementById('nome').value;
                    const categoriaIdade = categoriaSelect.value;
                    const totalPagarValor = totalPagar.innerText.replace('R$ ', '').replace(',', '.'); 

                    const urlPagamento = `pagamentos.html?atleta=${encodeURIComponent(nomeAtleta)}&categoria=${encodeURIComponent(categoriaIdade)}&valor=${totalPagarValor}`;

                    window.location.href = urlPagamento; 
                    
                } else {
                    feedbackElement.textContent = '‚ùå Erro ao salvar na planilha. Tente novamente.';
                    feedbackElement.style.backgroundColor = '#f8d7da';
                    feedbackElement.style.color = '#721c24';
                }

            } catch (error) {
                console.error('Erro de conex√£o ou Apps Script:', error);
                feedbackElement.textContent = '‚ùå Erro de rede. Tente novamente.';
                feedbackElement.style.backgroundColor = '#f8d7da';
                feedbackElement.style.color = '#721c24';
            }
        }
        // --- FIM DA FUN√á√ÉO DE ENVIO ---


        // --- Event Listeners ---
        dataNascimentoInput.addEventListener('change', popularCategorias);
        sexoInput.addEventListener('change', popularCategorias); 
        categoriaSelect.addEventListener('change', popularFaixas); 
        faixaInput.addEventListener('change', popularPesos); 

        // NOVOS LISTENERS PARA EQUIPE E PROFESSOR
        equipeSelect.addEventListener('change', gerenciarEquipe);
        equipeOutraInput.addEventListener('input', gerenciarEquipe); // Atualiza o hidden input enquanto digita

        professorSelect.addEventListener('change', gerenciarProfessor);
        professorOutroInput.addEventListener('input', gerenciarProfessor); // Atualiza o hidden input enquanto digita
        // FIM NOVOS LISTENERS

        // O peso e absoluto s√≥ precisam atualizar o extrato
        pesoInput.addEventListener('change', atualizarExtrato); 
        absolutoCheckbox.addEventListener('change', atualizarExtrato);
        
        inscricaoForm.addEventListener('submit', enviarParaPlanilha);
        
        popularCategorias(); // Inicia a UI, garantindo que os campos estejam desabilitados inicialmente.
    </script>
</body>
</html>
